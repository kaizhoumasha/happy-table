{"version":3,"file":"browser-optimization-Aw-vm1Jr.js","names":[],"sources":["../src/utils/browser-optimization.ts"],"sourcesContent":["/**\n * Browser Performance Optimization Utilities\n *\n * Features:\n * - Hardware acceleration management\n * - Passive event listeners\n * - Critical rendering path optimization\n * - Browser-specific optimizations\n * - Intersection Observer pooling\n * - RequestAnimationFrame utilities\n */\n\n// Browser feature detection\nexport const BrowserFeatures = {\n  // Check for IntersectionObserver support\n  get hasIntersectionObserver(): boolean {\n    return 'IntersectionObserver' in window\n  },\n\n  // Check for ResizeObserver support\n  get hasResizeObserver(): boolean {\n    return 'ResizeObserver' in window\n  },\n\n  // Check for passive event listener support\n  get hasPassiveEvents(): boolean {\n    let passive = false\n    try {\n      const options = Object.defineProperty({}, 'passive', {\n        get() {\n          passive = true\n          return false\n        },\n      })\n      window.addEventListener('test', () => {}, options)\n      window.removeEventListener('test', () => {}, options)\n    } catch (_e) {\n      passive = false\n    }\n    return passive\n  },\n\n  // Check for Web Workers support\n  get hasWebWorkers(): boolean {\n    return 'Worker' in window\n  },\n\n  // Check for OffscreenCanvas support\n  get hasOffscreenCanvas(): boolean {\n    return 'OffscreenCanvas' in window\n  },\n\n  // Check for CSS containment support\n  get hasContainment(): boolean {\n    return CSS.supports('contain', 'layout style paint')\n  },\n\n  // Check for CSS transforms support\n  get hasTransforms(): boolean {\n    return CSS.supports('transform', 'translateZ(0)')\n  },\n\n  // Detect browser type for specific optimizations\n  get browser(): 'chrome' | 'firefox' | 'safari' | 'edge' | 'other' {\n    const ua = navigator.userAgent\n    if (ua.includes('Chrome') && !ua.includes('Edge')) return 'chrome'\n    if (ua.includes('Firefox')) return 'firefox'\n    if (ua.includes('Safari') && !ua.includes('Chrome')) return 'safari'\n    if (ua.includes('Edge')) return 'edge'\n    return 'other'\n  },\n}\n\n// Hardware acceleration utilities\nexport class HardwareAcceleration {\n  private acceleratedElements = new WeakSet<HTMLElement>()\n\n  enable(element: HTMLElement, force = false): void {\n    if (this.acceleratedElements.has(element) && !force) return\n\n    // Use transform3d to trigger hardware acceleration\n    element.style.transform = element.style.transform\n      ? `${element.style.transform} translateZ(0)`\n      : 'translateZ(0)'\n\n    element.style.willChange = 'transform'\n    element.style.backfaceVisibility = 'hidden'\n\n    // Browser-specific optimizations\n    if (BrowserFeatures.browser === 'safari') {\n      element.style.webkitBackfaceVisibility = 'hidden'\n      element.style.webkitPerspective = '1000px'\n    }\n\n    this.acceleratedElements.add(element)\n  }\n\n  disable(element: HTMLElement): void {\n    if (!this.acceleratedElements.has(element)) return\n\n    // Reset transform (remove translateZ(0))\n    const transform = element.style.transform\n    element.style.transform = transform.replace(/translateZ\\(0px?\\)\\s*/g, '').trim()\n\n    element.style.willChange = 'auto'\n    element.style.backfaceVisibility = ''\n\n    if (BrowserFeatures.browser === 'safari') {\n      element.style.webkitBackfaceVisibility = ''\n      element.style.webkitPerspective = ''\n    }\n\n    this.acceleratedElements.delete(element)\n  }\n\n  isEnabled(element: HTMLElement): boolean {\n    return this.acceleratedElements.has(element)\n  }\n}\n\n// Critical rendering path optimization\nexport class CriticalRenderingOptimizer {\n  private styleSheets = new Map<string, CSSStyleSheet>()\n  private criticalCSS = new Set<string>()\n\n  // Inline critical CSS for first paint optimization\n  inlineCriticalCSS(css: string, id: string): void {\n    if (this.criticalCSS.has(id)) return\n\n    const style = document.createElement('style')\n    style.setAttribute('data-critical', id)\n    style.textContent = css\n    document.head.insertBefore(style, document.head.firstChild)\n\n    this.criticalCSS.add(id)\n  }\n\n  // Lazy load non-critical CSS\n  loadNonCriticalCSS(href: string, id: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (this.styleSheets.has(id)) {\n        resolve()\n        return\n      }\n\n      const link = document.createElement('link')\n      link.rel = 'stylesheet'\n      link.href = href\n      link.setAttribute('data-non-critical', id)\n\n      link.onload = () => {\n        this.styleSheets.set(id, link.sheet as CSSStyleSheet)\n        resolve()\n      }\n\n      link.onerror = reject\n\n      // Use requestIdleCallback if available for better performance\n      if ('requestIdleCallback' in window) {\n        requestIdleCallback(() => {\n          document.head.appendChild(link)\n        })\n      } else {\n        setTimeout(() => {\n          document.head.appendChild(link)\n        }, 0)\n      }\n    })\n  }\n\n  // Preload resources with appropriate hints\n  preloadResource(href: string, as: string, type?: string): void {\n    const link = document.createElement('link')\n    link.rel = 'preload'\n    link.href = href\n    link.setAttribute('as', as)\n    if (type) link.type = type\n\n    document.head.appendChild(link)\n  }\n\n  // Font loading optimization\n  optimizeFontLoading(fontFamily: string, fontDisplay = 'swap'): void {\n    const style = document.createElement('style')\n    style.textContent = `\n      @font-face {\n        font-family: '${fontFamily}';\n        font-display: ${fontDisplay};\n      }\n    `\n    document.head.appendChild(style)\n  }\n}\n\n// Event listener optimization\nexport class OptimizedEventManager {\n  private listeners = new Map<EventTarget, Map<string, Set<EventListener>>>()\n\n  addEventListener(\n    target: EventTarget,\n    type: string,\n    listener: EventListener,\n    options?: AddEventListenerOptions | boolean\n  ): void {\n    // Use passive listeners for better performance\n    const optimizedOptions = this.getOptimizedOptions(type, options)\n\n    target.addEventListener(type, listener, optimizedOptions)\n\n    // Track for cleanup\n    if (!this.listeners.has(target)) {\n      this.listeners.set(target, new Map())\n    }\n\n    const targetListeners = this.listeners.get(target)!\n    if (!targetListeners.has(type)) {\n      targetListeners.set(type, new Set())\n    }\n\n    targetListeners.get(type)!.add(listener)\n  }\n\n  removeEventListener(\n    target: EventTarget,\n    type: string,\n    listener: EventListener,\n    options?: EventListenerOptions | boolean\n  ): void {\n    target.removeEventListener(type, listener, options)\n\n    // Update tracking\n    const targetListeners = this.listeners.get(target)\n    if (targetListeners) {\n      const typeListeners = targetListeners.get(type)\n      if (typeListeners) {\n        typeListeners.delete(listener)\n        if (typeListeners.size === 0) {\n          targetListeners.delete(type)\n        }\n      }\n      if (targetListeners.size === 0) {\n        this.listeners.delete(target)\n      }\n    }\n  }\n\n  private getOptimizedOptions(\n    type: string,\n    options?: AddEventListenerOptions | boolean\n  ): AddEventListenerOptions | boolean {\n    // Default to passive for scroll and touch events\n    const passiveEvents = ['scroll', 'wheel', 'touchstart', 'touchmove', 'touchend']\n\n    if (typeof options === 'object' && options !== null) {\n      return {\n        ...options,\n        passive:\n          options.passive !== undefined\n            ? options.passive\n            : passiveEvents.includes(type) && BrowserFeatures.hasPassiveEvents,\n      }\n    }\n\n    if (passiveEvents.includes(type) && BrowserFeatures.hasPassiveEvents) {\n      return { passive: true }\n    }\n\n    return options || false\n  }\n\n  cleanup(): void {\n    for (const [target, typeMap] of this.listeners.entries()) {\n      for (const [type, listeners] of typeMap.entries()) {\n        for (const listener of listeners) {\n          target.removeEventListener(type, listener)\n        }\n      }\n    }\n    this.listeners.clear()\n  }\n}\n\n// RequestAnimationFrame utilities\nexport class RAFScheduler {\n  private callbacks = new Map<number, () => void>()\n  private currentId = 0\n  private isRunning = false\n\n  schedule(callback: () => void): number {\n    const id = ++this.currentId\n    this.callbacks.set(id, callback)\n\n    if (!this.isRunning) {\n      this.start()\n    }\n\n    return id\n  }\n\n  cancel(id: number): void {\n    this.callbacks.delete(id)\n  }\n\n  private start(): void {\n    this.isRunning = true\n\n    const tick = () => {\n      if (this.callbacks.size === 0) {\n        this.isRunning = false\n        return\n      }\n\n      // Execute all scheduled callbacks\n      const callbacks = Array.from(this.callbacks.values())\n      this.callbacks.clear()\n\n      callbacks.forEach(callback => {\n        try {\n          callback()\n        } catch (error) {\n          import('./logger').then(({ createLogger }) => {\n            const logger = createLogger('BrowserOptimization')\n            logger.error('RAF callback error:', { module: 'BrowserOptimization' }, error)\n          })\n        }\n      })\n\n      requestAnimationFrame(tick)\n    }\n\n    requestAnimationFrame(tick)\n  }\n\n  scheduleWithPriority(\n    callback: () => void,\n    priority: 'high' | 'normal' | 'low' = 'normal'\n  ): number {\n    if (priority === 'high') {\n      // Execute immediately in next frame\n      return this.schedule(callback)\n    } else if (priority === 'low') {\n      // Use requestIdleCallback if available\n      if ('requestIdleCallback' in window) {\n        const id = requestIdleCallback(callback)\n        return id as number\n      }\n    }\n\n    // Normal priority\n    return this.schedule(callback)\n  }\n}\n\n// Intersection Observer pooling for better performance\nexport class IntersectionObserverPool {\n  private observers = new Map<string, IntersectionObserver>()\n  private elementCallbacks = new WeakMap<Element, Map<string, IntersectionObserverCallback>>()\n\n  observe(\n    element: Element,\n    callback: IntersectionObserverCallback,\n    options: IntersectionObserverInit = {}\n  ): () => void {\n    const key = this.getObserverKey(options)\n\n    if (!this.observers.has(key)) {\n      this.observers.set(\n        key,\n        new IntersectionObserver((entries, observer) => {\n          entries.forEach(entry => {\n            const callbacks = this.elementCallbacks.get(entry.target)\n            if (callbacks) {\n              callbacks.forEach(cb => cb([entry], observer))\n            }\n          })\n        }, options)\n      )\n    }\n\n    const observer = this.observers.get(key)!\n\n    // Track callback for this element\n    if (!this.elementCallbacks.has(element)) {\n      this.elementCallbacks.set(element, new Map())\n    }\n\n    const callbackId = Math.random().toString(36)\n    this.elementCallbacks.get(element)!.set(callbackId, callback)\n\n    observer.observe(element)\n\n    // Return cleanup function\n    return () => {\n      const callbacks = this.elementCallbacks.get(element)\n      if (callbacks) {\n        callbacks.delete(callbackId)\n        if (callbacks.size === 0) {\n          observer.unobserve(element)\n          this.elementCallbacks.delete(element)\n        }\n      }\n    }\n  }\n\n  private getObserverKey(options: IntersectionObserverInit): string {\n    return JSON.stringify({\n      root: (options.root as Element)?.tagName || null,\n      rootMargin: options.rootMargin || '0px',\n      threshold: options.threshold || 0,\n    })\n  }\n\n  cleanup(): void {\n    this.observers.forEach(observer => observer.disconnect())\n    this.observers.clear()\n  }\n}\n\n// Browser-specific optimization strategies\nexport class BrowserOptimizations {\n  private hardwareAccel = new HardwareAcceleration()\n  private renderOptimizer = new CriticalRenderingOptimizer()\n  private _eventManager = new OptimizedEventManager()\n  private rafScheduler = new RAFScheduler()\n  private intersectionPool = new IntersectionObserverPool()\n\n  // Apply optimizations based on browser capabilities\n  optimizeForBrowser(element: HTMLElement): void {\n    const browser = BrowserFeatures.browser\n\n    switch (browser) {\n      case 'chrome':\n        this.optimizeForChrome(element)\n        break\n      case 'firefox':\n        this.optimizeForFirefox(element)\n        break\n      case 'safari':\n        this.optimizeForSafari(element)\n        break\n      case 'edge':\n        this.optimizeForEdge(element)\n        break\n    }\n  }\n\n  private optimizeForChrome(element: HTMLElement): void {\n    // Chrome-specific optimizations\n    this.hardwareAccel.enable(element)\n\n    // Use CSS containment if supported\n    if (BrowserFeatures.hasContainment) {\n      element.style.contain = 'layout style paint'\n    }\n\n    // Optimize for Chrome's compositor\n    element.style.isolation = 'isolate'\n  }\n\n  private optimizeForFirefox(element: HTMLElement): void {\n    // Firefox-specific optimizations\n    this.hardwareAccel.enable(element)\n\n    // Firefox performs better with will-change hints\n    element.style.willChange = 'transform, opacity'\n  }\n\n  private optimizeForSafari(element: HTMLElement): void {\n    // Safari-specific optimizations\n    this.hardwareAccel.enable(element)\n\n    // Safari benefits from explicit transform styles\n    element.style.webkitTransform = 'translateZ(0)'\n    element.style.webkitBackfaceVisibility = 'hidden'\n  }\n\n  private optimizeForEdge(element: HTMLElement): void {\n    // Edge-specific optimizations\n    this.hardwareAccel.enable(element)\n\n    // Edge benefits from explicit GPU layers\n    element.style.transform = 'translateZ(0)'\n  }\n\n  // Critical path optimization\n  optimizeCriticalPath(): void {\n    // Inline critical grid styles\n    this.renderOptimizer.inlineCriticalCSS(\n      `\n      .ht-grid-container {\n        contain: layout style paint;\n        transform: translateZ(0);\n        will-change: scroll-position;\n      }\n      .ht-virtual-item {\n        contain: layout style paint;\n        will-change: transform;\n        backface-visibility: hidden;\n      }\n    `,\n      'ht-critical'\n    )\n\n    // Preload fonts if needed\n    this.renderOptimizer.optimizeFontLoading('system-ui', 'swap')\n  }\n\n  // Event optimization\n  addOptimizedListener(\n    target: EventTarget,\n    type: string,\n    listener: EventListener,\n    options?: AddEventListenerOptions\n  ): void {\n    this._eventManager.addEventListener(target, type, listener, options)\n  }\n\n  // Cleanup\n  cleanup(): void {\n    this._eventManager.cleanup()\n    this.intersectionPool.cleanup()\n  }\n\n  // Getters for individual optimizers\n  get hardwareAcceleration(): HardwareAcceleration {\n    return this.hardwareAccel\n  }\n\n  get renderingOptimizer(): CriticalRenderingOptimizer {\n    return this.renderOptimizer\n  }\n\n  get eventManager(): OptimizedEventManager {\n    return this._eventManager\n  }\n\n  get scheduler(): RAFScheduler {\n    return this.rafScheduler\n  }\n\n  get intersectionObserver(): IntersectionObserverPool {\n    return this.intersectionPool\n  }\n}\n\n// Export singleton instance\nexport const browserOptimizations = new BrowserOptimizations()\n\n// Initialize optimizations\nexport function initializeBrowserOptimizations(): void {\n  // Apply critical path optimizations immediately\n  browserOptimizations.optimizeCriticalPath()\n\n  // Add unload cleanup\n  window.addEventListener('beforeunload', () => {\n    browserOptimizations.cleanup()\n  })\n}\n\n// Performance hints for developers\nexport const PerformanceHints = {\n  // Recommend hardware acceleration for elements\n  shouldAccelerate: (element: HTMLElement): boolean => {\n    const rect = element.getBoundingClientRect()\n    return rect.width * rect.height > 10000 // Large elements benefit more\n  },\n\n  // Recommend passive event listeners\n  shouldUsePassive: (eventType: string): boolean => {\n    return ['scroll', 'wheel', 'touchstart', 'touchmove'].includes(eventType)\n  },\n\n  // Recommend CSS containment\n  shouldUseContainment: (element: HTMLElement): boolean => {\n    return element.children.length > 10 || element.scrollHeight > window.innerHeight\n  },\n}\n"],"mappings":"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"}