const e={get hasIntersectionObserver(){return`IntersectionObserver`in window},get hasResizeObserver(){return`ResizeObserver`in window},get hasPassiveEvents(){let e=!1;try{let t=Object.defineProperty({},`passive`,{get(){return e=!0,!1}});window.addEventListener(`test`,()=>{},t),window.removeEventListener(`test`,()=>{},t)}catch{e=!1}return e},get hasWebWorkers(){return`Worker`in window},get hasOffscreenCanvas(){return`OffscreenCanvas`in window},get hasContainment(){return CSS.supports(`contain`,`layout style paint`)},get hasTransforms(){return CSS.supports(`transform`,`translateZ(0)`)},get browser(){let e=navigator.userAgent;return e.includes(`Chrome`)&&!e.includes(`Edge`)?`chrome`:e.includes(`Firefox`)?`firefox`:e.includes(`Safari`)&&!e.includes(`Chrome`)?`safari`:e.includes(`Edge`)?`edge`:`other`}};var t=class{acceleratedElements=new WeakSet;enable(t,n=!1){this.acceleratedElements.has(t)&&!n||(t.style.transform=t.style.transform?`${t.style.transform} translateZ(0)`:`translateZ(0)`,t.style.willChange=`transform`,t.style.backfaceVisibility=`hidden`,e.browser===`safari`&&(t.style.webkitBackfaceVisibility=`hidden`,t.style.webkitPerspective=`1000px`),this.acceleratedElements.add(t))}disable(t){if(!this.acceleratedElements.has(t))return;let n=t.style.transform;t.style.transform=n.replace(/translateZ\(0px?\)\s*/g,``).trim(),t.style.willChange=`auto`,t.style.backfaceVisibility=``,e.browser===`safari`&&(t.style.webkitBackfaceVisibility=``,t.style.webkitPerspective=``),this.acceleratedElements.delete(t)}isEnabled(e){return this.acceleratedElements.has(e)}},n=class{styleSheets=new Map;criticalCSS=new Set;inlineCriticalCSS(e,t){if(this.criticalCSS.has(t))return;let n=document.createElement(`style`);n.setAttribute(`data-critical`,t),n.textContent=e,document.head.insertBefore(n,document.head.firstChild),this.criticalCSS.add(t)}loadNonCriticalCSS(e,t){return new Promise((n,r)=>{if(this.styleSheets.has(t)){n();return}let i=document.createElement(`link`);i.rel=`stylesheet`,i.href=e,i.setAttribute(`data-non-critical`,t),i.onload=()=>{this.styleSheets.set(t,i.sheet),n()},i.onerror=r,`requestIdleCallback`in window?requestIdleCallback(()=>{document.head.appendChild(i)}):setTimeout(()=>{document.head.appendChild(i)},0)})}preloadResource(e,t,n){let r=document.createElement(`link`);r.rel=`preload`,r.href=e,r.setAttribute(`as`,t),n&&(r.type=n),document.head.appendChild(r)}optimizeFontLoading(e,t=`swap`){let n=document.createElement(`style`);n.textContent=`
      @font-face {
        font-family: '${e}';
        font-display: ${t};
      }
    `,document.head.appendChild(n)}},r=class{listeners=new Map;addEventListener(e,t,n,r){let i=this.getOptimizedOptions(t,r);e.addEventListener(t,n,i),this.listeners.has(e)||this.listeners.set(e,new Map);let a=this.listeners.get(e);a.has(t)||a.set(t,new Set),a.get(t).add(n)}removeEventListener(e,t,n,r){e.removeEventListener(t,n,r);let i=this.listeners.get(e);if(i){let r=i.get(t);r&&(r.delete(n),r.size===0&&i.delete(t)),i.size===0&&this.listeners.delete(e)}}getOptimizedOptions(t,n){let r=[`scroll`,`wheel`,`touchstart`,`touchmove`,`touchend`];return typeof n==`object`&&n?{...n,passive:n.passive===void 0?r.includes(t)&&e.hasPassiveEvents:n.passive}:r.includes(t)&&e.hasPassiveEvents?{passive:!0}:n||!1}cleanup(){for(let[e,t]of this.listeners.entries())for(let[n,r]of t.entries())for(let t of r)e.removeEventListener(n,t);this.listeners.clear()}},i=class{callbacks=new Map;currentId=0;isRunning=!1;schedule(e){let t=++this.currentId;return this.callbacks.set(t,e),this.isRunning||this.start(),t}cancel(e){this.callbacks.delete(e)}start(){this.isRunning=!0;let e=()=>{if(this.callbacks.size===0){this.isRunning=!1;return}let t=Array.from(this.callbacks.values());this.callbacks.clear(),t.forEach(e=>{try{e()}catch(e){Promise.resolve().then(()=>require(`./logger-COTt4mxw.cjs`)).then(({createLogger:t})=>{t(`BrowserOptimization`).error(`RAF callback error:`,{module:`BrowserOptimization`},e)})}}),requestAnimationFrame(e)};requestAnimationFrame(e)}scheduleWithPriority(e,t=`normal`){return t===`high`?this.schedule(e):t===`low`&&`requestIdleCallback`in window?requestIdleCallback(e):this.schedule(e)}},a=class{observers=new Map;elementCallbacks=new WeakMap;observe(e,t,n={}){let r=this.getObserverKey(n);this.observers.has(r)||this.observers.set(r,new IntersectionObserver((e,t)=>{e.forEach(e=>{let n=this.elementCallbacks.get(e.target);n&&n.forEach(n=>n([e],t))})},n));let i=this.observers.get(r);this.elementCallbacks.has(e)||this.elementCallbacks.set(e,new Map);let a=Math.random().toString(36);return this.elementCallbacks.get(e).set(a,t),i.observe(e),()=>{let t=this.elementCallbacks.get(e);t&&(t.delete(a),t.size===0&&(i.unobserve(e),this.elementCallbacks.delete(e)))}}getObserverKey(e){return JSON.stringify({root:e.root?.tagName||null,rootMargin:e.rootMargin||`0px`,threshold:e.threshold||0})}cleanup(){this.observers.forEach(e=>e.disconnect()),this.observers.clear()}},o=class{hardwareAccel=new t;renderOptimizer=new n;_eventManager=new r;rafScheduler=new i;intersectionPool=new a;optimizeForBrowser(t){switch(e.browser){case`chrome`:this.optimizeForChrome(t);break;case`firefox`:this.optimizeForFirefox(t);break;case`safari`:this.optimizeForSafari(t);break;case`edge`:this.optimizeForEdge(t);break}}optimizeForChrome(t){this.hardwareAccel.enable(t),e.hasContainment&&(t.style.contain=`layout style paint`),t.style.isolation=`isolate`}optimizeForFirefox(e){this.hardwareAccel.enable(e),e.style.willChange=`transform, opacity`}optimizeForSafari(e){this.hardwareAccel.enable(e),e.style.webkitTransform=`translateZ(0)`,e.style.webkitBackfaceVisibility=`hidden`}optimizeForEdge(e){this.hardwareAccel.enable(e),e.style.transform=`translateZ(0)`}optimizeCriticalPath(){this.renderOptimizer.inlineCriticalCSS(`
      .ht-grid-container {
        contain: layout style paint;
        transform: translateZ(0);
        will-change: scroll-position;
      }
      .ht-virtual-item {
        contain: layout style paint;
        will-change: transform;
        backface-visibility: hidden;
      }
    `,`ht-critical`),this.renderOptimizer.optimizeFontLoading(`system-ui`,`swap`)}addOptimizedListener(e,t,n,r){this._eventManager.addEventListener(e,t,n,r)}cleanup(){this._eventManager.cleanup(),this.intersectionPool.cleanup()}get hardwareAcceleration(){return this.hardwareAccel}get renderingOptimizer(){return this.renderOptimizer}get eventManager(){return this._eventManager}get scheduler(){return this.rafScheduler}get intersectionObserver(){return this.intersectionPool}};const s=new o;function c(){s.optimizeCriticalPath(),window.addEventListener(`beforeunload`,()=>{s.cleanup()})}Object.defineProperty(exports,`BrowserFeatures`,{enumerable:!0,get:function(){return e}}),Object.defineProperty(exports,`BrowserOptimizations`,{enumerable:!0,get:function(){return o}}),Object.defineProperty(exports,`CriticalRenderingOptimizer`,{enumerable:!0,get:function(){return n}}),Object.defineProperty(exports,`HardwareAcceleration`,{enumerable:!0,get:function(){return t}}),Object.defineProperty(exports,`IntersectionObserverPool`,{enumerable:!0,get:function(){return a}}),Object.defineProperty(exports,`OptimizedEventManager`,{enumerable:!0,get:function(){return r}}),Object.defineProperty(exports,`RAFScheduler`,{enumerable:!0,get:function(){return i}}),Object.defineProperty(exports,`browserOptimizations`,{enumerable:!0,get:function(){return s}}),Object.defineProperty(exports,`initializeBrowserOptimizations`,{enumerable:!0,get:function(){return c}});
//# sourceMappingURL=browser-optimization-BvGvv3w1.cjs.map